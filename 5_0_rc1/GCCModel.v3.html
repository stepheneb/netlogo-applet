<html>
<head>
<title>GCCModel.v3</title>
<style type="text/css">
<!--
/*
    This style sheet is borrowed from the NetLogo User Manual.  However, some of the units were
    changed from em to px because Java's StyleSheet support is limited for relative units such as
    em and % (this will supposively improve with newer versions of the VM) - jrn 7/21/05
    BE VERY VERY CAREFUL when you alter this style sheet -- it's possible to put in
    innocent-looking things that work on some VM's but cause Java exceptions on other for example
    we were using "font-size: 125%" but it caused Java exceptions on Java 1.5 on Windows - ST
    8/25/05
*/
:link { color: rgb(110,0,110); }
:visited { color: rgb(110,0,110); }
body {
    margin-left: 5px;
    font-family: arial, sans-serif;
    background: white;
    font-size: 12pt
}
h1 {
    color: white;
    background: rgb(45,0,45);
    font-size: 18pt;
    margin-bottom: 4px;
    padding-left: 6px;
    padding-right: 6px;
    padding-top: 6px;
    padding-bottom: 6px;
}
h2 {
    margin-top: 15px;
    margin-left: 6px;
    margin-bottom: 4px;
    background: rgb(166,172,255);
    font-size: 15pt;
    padding-left: 6px;
    padding-right: 6px;
    padding-top: 6px;
    padding-bottom: 6px;
}
h3 {
    margin-top: 15px;
    margin-left: 13px;
    margin-bottom: 4px;
    background: rgb(175,175,175);
    font-size: 12pt;
    padding: 0.2em;
    padding-left: 6px;
    padding-right: 6px;
    padding-top: 6px;
    padding-bottom: 6px;
}
h4 {
    margin-top: 15px;
    margin-bottom: 5px;
    margin-left: 15px;
    font-size: 12pt;
}
h5 {
    margin-top: 15px;
    margin-left: 15px;
    font-size: 12pt;
}
h6 {
    margin-top: 15px;
    margin-left: 15px;
    font-size: 12pt;
}
p {
    margin-left: 15px;
    margin-bottom: 3px;
}
pre {
    margin-left: 13px;
    background: rgb(225,225,225);
    font-family: monospace;
    font-size: 12pt;
    padding-left: 10px;
    padding-right: 3px;
    padding-top: 7px;
    padding-bottom: 7px;
    margin-top:9px;
    margin-bottom:0px;
}
code {
    font-family: monospace;
    font-size: 12pt;
}
blockquote {
    border: solid;
    border-style: solid;
    border-width: thin;
    border-color: black;
    background: rgb(250,250,220);
    padding-top: 0px;
    padding-bottom: 7px;
    margin-top: 7px;
    margin-bottom:1px;
}
ol {
   margin-bottom:1px;
}
ul {
   margin-bottom:1px;
}

-->
</style>
</head>
<body>

<p>This page was automatically generated by NetLogo 5.0RC1.</p>

<p>
<applet code="org.nlogo.lite.Applet"
        archive="NetLogoLite.jar"
        width="589" height="442">
  <param name="DefaultModel"
         value="GCCModel.v3.nlogo">
  <param name="java_arguments"
         value="-Djnlp.packEnabled=true">
</applet>
</p>

<p>powered by
<a target="_blank" href="http://ccl.northwestern.edu/netlogo/">NetLogo</a></p>

<p>view/download model file:
<a href="GCCModel.v3.nlogo">GCCModel.v3.nlogo</a></p>
<h2>WHAT IS IT?</h2><p>This is a model of energy flow in the earth. It shows the earth as rose colored. On the earth surface is a green strip. Above that is a blue atmosphere and black space at the top. Clouds and CO2 molecules can be added to the atmosphere. The CO2 molecules represent greenhouse gasses that block infrared light that the earth emits. </p><h2>HOW IT WORKS</h2><p>Yellow arrowheads stream downward representing sunlight energy. Some of the sunlight reflects off clouds and more can reflect off the earth surface. </p><p>If sunlight is absorbed by the earth, it turns into a red dot, representing heat energy. Each dot represents the energy of one yellow sunlight arrowhead. The red dots randomly move around the earth. The temperature of the earth is related to the total number of red dots. </p><p>Sometimes the red dots transform into infrared (IR) light that heads toward space, carrying off energy. The probability of a red dot becoming IR light depends on the earth temperature. When the earth is cold, few red dots cause IR light; when it is hot, most do. The IR energy is represented by a magenta arrowhead. Each carries the same energy as a yellow arrowhead and as a red dot. The IR light goes through clouds but can bounce off CO2 molecules. </p><h2>HOW TO USE IT</h2><p>The &ldquo;sun-brightness&rdquo; slider controls how much sun energy enters the earth atmosphere. A value of 1.0 corresponds to our sun. Higher values allow you to see what would happen if the earth was closer to the sun, or if the sun got brighter. </p><p>The &ldquo;albedo&rdquo; slider controls how much of the sun energy hitting the earth is absorbed.<br/>If the albedo is 1.0, the earth reflects all sunlight. This could happen if the earth froze and is indicated by a white surface. If the albedo is zero, the earth absorbs all sunlight. This is indicated as a black surface. The earth&rsquo;s albedo is about 0.6. </p><p>You can add and remove clouds with buttons. Clouds block sunlight but not IR. </p><p>You can add and remove greenhouse gasses, represented as CO2 molecules. CO2 blocks IR light but not sunlight. The buttons add and subtract molecules in groups of 25 up to 150.</p><p>The temperature of the earth is related to the amount of heat in the earth. The more red dots you see, the hotter it is. </p><h2>THINGS TO NOTICE</h2><p>Follow a single sunlight arrowhead. This easier if you slow down the model using the slider at the top of the model. </p><p>Here is a better way to follow an arrowhead. Stop the model and control-click on an arrowhead, select the last item &ldquo;turle&rdquo; followed by a number. This opens a sub-menu where you can select &ldquo;watch&rdquo; followed by a number. Now when you run the model, you will see a circle around that arrowhead. </p><p>What happens to the arrowhead when it hits the earth? Describe its later path. Does it escape the earth? What happens then? Do all arrowheads follow similar paths? </p><h2>THINGS TO TRY</h2>
<ol>
  <li><p>Play with model. Change the albedo and run the model.<br/>Add clouds and CO2 to the model and then watch a single sunlight arrowhead.<br/>What is the highest earth temperature you can produce?</p></li>
  <li><p>Run the model with a bright sun but no clouds and no CO2. What happens to the temperature? It should rise quickly and then settle down around 50 degrees. Why does it stop rising? Why does the temperatuer continue to bounce around? Remember, the temperature reflects the number of red dots in the earth. When the temperature is constant, there about as many incoming yellow arrowheads as outgoing IR ones. Why? </p></li>
  <li><p>Explore the effect of albedo holding everything else constant. Does increasing the albedo increase or decrease the earth temperature? When you experiment, be sure to run the model long enough for the temperature to settle down. </p></li>
  <li><p>Explore the effect of clouds holding everything else constant. </p></li>
  <li><p>Explore the effect of adding 100 CO2 molecules. What is the cause of the change you observe. Follow one sunlight arrowhead now. </p></li>
</ol><h2>DETAILS ABOUT THE MODEL</h2><p>There is a relation between the number of red dots in the earth and the temperature of the earth. This is because the earth temperature goes up as the total thermal energy is increased. Thermal energy is added by sunlight that reaches the earth as well as from infrared (IR) light reflected down to the earth. Thermal energy is removed by IR emitted by the earth. The balance of these determines the energy in the earth with is proportional to its temperature. </p><p>There are, of course, many simplifications in this model. The earth is not a single temperature, does not have a single albedo, and does not have a single heat capacity. Visible light is somewhat absorbed by CO2 and some IR light does bounce off clouds. No model is completely accurate. What is important, is that a model react in some ways like the system it is supposed to model. This model does that, showing how the greenhouse effect is caused by CO2 and other gases that absorb IR. </p><h2>CREDITS AND REFERENCES</h2><p>Created Nov 19, 2005 by Robert Tinker for the TELS project. Updated Jan 9, 2006. </p>

<h1>CODE</h1>
<pre><font color="#007f69">breed</font><font color="#000000"> [ clouds cloud ]
</font><font color="#660096">breed</font><font color="#000000"> [ sunrays sunray]
</font><font color="#660096">breed</font><font color="#000000"> [ IRs IR ]
</font><font color="#660096">breed</font><font color="#000000"> [ heats heat ]
</font><font color="#660096">breed</font><font color="#000000"> [ CO2s CO2 ]
</font><font color="#660096">breed</font><font color="#000000"> [ static-labels static-label] 
</font><font color="#660096">breed</font><font color="#000000"> [ circles circle]

</font><font color="#007f69">clouds-own</font><font color="#000000"> [ cloud-num ]
</font><font color="#007f69">globals</font><font color="#000000"> [ sky-top 
  earth-top 
  temperature 
  num-CO2 
  num-clouds 
  starter 
  albedo 
  sun-brightness
  ]

</font><font color="#007f69">to</font><font color="#000000"> startup
  </font><font color="#0000aa">clear-all</font><font color="#000000">
  setup-world
  setup-labels           </font><font color="#5a5a5a">; create hidden static labels and circles (that identify a ray or heat)</font><font color="#000000">
  show-labels             </font><font color="#5a5a5a">; show the labels on startup</font><font color="#000000">
  </font><font color="#0000aa">set</font><font color="#000000"> temperature </font><font color="#963700">12</font><font color="#000000">     </font><font color="#5a5a5a">; start with a cold earth</font><font color="#000000">
  </font><font color="#0000aa">reset-ticks</font><font color="#000000">
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> setup-labels
  </font><font color="#5a5a5a">; create and place the static labels and create the circles used to label rays and heat</font><font color="#000000">
  </font><font color="#5a5a5a">; hide them all</font><font color="#000000">
  create-static-labels </font><font color="#963700">1</font><font color="#000000"> [
    </font><font color="#0000aa">setxy</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> 
    </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">label</font><font color="#000000"> </font><font color="#963700">&quot;Air&quot;</font><font color="#000000">]
  create-static-labels </font><font color="#963700">1</font><font color="#000000"> [
    </font><font color="#0000aa">setxy</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> Earth-top </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">.4</font><font color="#000000">
    </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">label</font><font color="#000000"> </font><font color="#963700">&quot;Earth Surface&quot;</font><font color="#000000">]
  create-static-labels </font><font color="#963700">1</font><font color="#000000"> [
    </font><font color="#0000aa">setxy</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> </font><font color="#660096">max-pycor</font><font color="#000000"> </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000">
    </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">label</font><font color="#000000"> </font><font color="#963700">&quot;Space&quot;</font><font color="#000000">]
  create-static-labels </font><font color="#963700">1</font><font color="#000000"> [
    </font><font color="#0000aa">setxy</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> </font><font color="#963700">.8</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> </font><font color="#660096">min-pycor</font><font color="#000000"> 
    </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">label</font><font color="#000000"> </font><font color="#963700">&quot;Earth Interior&quot;</font><font color="#000000">
    </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">label-color</font><font color="#000000"> </font><font color="#963700">black</font><font color="#000000">]
  </font><font color="#0000aa">ask</font><font color="#000000"> static-labels [</font><font color="#0000aa">ht</font><font color="#000000"> </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">]
  
  create-circles </font><font color="#963700">1</font><font color="#000000"> [   </font><font color="#5a5a5a">; used to draw attention to a heat dot</font><font color="#000000">
     </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">magenta</font><font color="#000000"> </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">label</font><font color="#000000"> </font><font color="#963700">&quot;IR ray&quot;</font><font color="#000000">]
  create-circles </font><font color="#963700">1</font><font color="#000000"> [   </font><font color="#5a5a5a">; used to draw attention to a sunray</font><font color="#000000">
     </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">yellow</font><font color="#000000"> </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">label</font><font color="#000000"> </font><font color="#963700">&quot;sun ray&quot;</font><font color="#000000">]
  create-circles </font><font color="#963700">1</font><font color="#000000"> [   </font><font color="#5a5a5a">; used to draw attention to a IR ray</font><font color="#000000">
     </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">red</font><font color="#000000"> </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">label</font><font color="#000000"> </font><font color="#963700">&quot;heat packet&quot;</font><font color="#000000">
     </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">label-color</font><font color="#000000"> </font><font color="#963700">black</font><font color="#000000">]
  </font><font color="#0000aa">ask</font><font color="#000000"> circles [ </font><font color="#0000aa">ht</font><font color="#000000"> </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000"> </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">shape</font><font color="#000000"> </font><font color="#963700">&quot;circle 3&quot;</font><font color="#000000"> ] </font><font color="#5a5a5a">; now the circles exist but are hidden. </font><font color="#000000">
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> hide-labels 
  </font><font color="#0000aa">ask</font><font color="#000000"> static-labels [</font><font color="#0000aa">ht</font><font color="#000000">]  </font><font color="#5a5a5a">; makes the lables invisible</font><font color="#000000">
  </font><font color="#0000aa">ask</font><font color="#000000"> circles [</font><font color="#0000aa">ht</font><font color="#000000">]        </font><font color="#5a5a5a">; makes the circles and their labels invisible </font><font color="#000000">
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> show-labels              </font><font color="#5a5a5a">; this shows all the static labels</font><font color="#000000">
                            </font><font color="#5a5a5a">; and finds a representative sunray, heat dot, and IR ray</font><font color="#000000">
                            </font><font color="#5a5a5a">; and circles each and adds a label </font><font color="#000000">
                            </font><font color="#5a5a5a">; the representative cannot be too close to another or to the edges of its world</font><font color="#000000">
  </font><font color="#0000aa">ask</font><font color="#000000"> static-labels [</font><font color="#0000aa">st</font><font color="#000000">]           </font><font color="#5a5a5a">; show all the static labels</font><font color="#000000">

  </font><font color="#0000aa">let</font><font color="#000000"> x </font><font color="#963700">0</font><font color="#000000"> </font><font color="#0000aa">let</font><font color="#000000"> y </font><font color="#963700">0</font><font color="#000000">
  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">any?</font><font color="#000000"> sunrays [
    </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">one-of</font><font color="#000000"> sunrays [</font><font color="#0000aa">set</font><font color="#000000"> x </font><font color="#660096">xcor</font><font color="#000000"> </font><font color="#0000aa">set</font><font color="#000000"> y </font><font color="#660096">ycor</font><font color="#000000">]
    </font><font color="#0000aa">ask</font><font color="#000000"> circles </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">color</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">yellow</font><font color="#000000">] [    </font><font color="#5a5a5a">;place a circle on the sunray and show the circle and its label</font><font color="#000000">
      </font><font color="#0000aa">setxy</font><font color="#000000"> x y </font><font color="#0000aa">st</font><font color="#000000"> ]]
  </font><font color="#0000aa">let</font><font color="#000000"> target </font><font color="#660096">one-of</font><font color="#000000"> IRs
  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">not</font><font color="#000000"> (target </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">nobody</font><font color="#000000">) [
    </font><font color="#0000aa">set</font><font color="#000000"> x [</font><font color="#660096">xcor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> target </font><font color="#0000aa">set</font><font color="#000000"> y [</font><font color="#660096">ycor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> target 
    </font><font color="#0000aa">ask</font><font color="#000000"> circles </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">color</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">magenta</font><font color="#000000">][
      </font><font color="#0000aa">setxy</font><font color="#000000"> x y </font><font color="#0000aa">st</font><font color="#000000">]]
  </font><font color="#0000aa">set</font><font color="#000000"> target </font><font color="#660096">one-of</font><font color="#000000"> heats
  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">not</font><font color="#000000"> (target </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">nobody</font><font color="#000000">) [
    </font><font color="#0000aa">set</font><font color="#000000"> x [</font><font color="#660096">xcor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> target </font><font color="#0000aa">set</font><font color="#000000"> y [</font><font color="#660096">ycor</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> target
    </font><font color="#0000aa">ask</font><font color="#000000"> circles </font><font color="#660096">with</font><font color="#000000"> [</font><font color="#660096">color</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">red</font><font color="#000000">][
    </font><font color="#0000aa">setxy</font><font color="#000000"> x y </font><font color="#0000aa">st</font><font color="#000000">]]
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to-report</font><font color="#000000"> good-location?
 
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> execute 
  hide-labels            </font><font color="#5a5a5a">; every cycle all the labels are first hidden and, at the end of the cycle, shown</font><font color="#000000">
  </font><font color="#0000aa">wait</font><font color="#000000"> </font><font color="#963700">10</font><font color="#000000"> </font><font color="#660096">/</font><font color="#000000"> (model_speed </font><font color="#660096">^</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000"> </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">15</font><font color="#000000">)
  </font><font color="#0000aa">if</font><font color="#000000"> (starter </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">) [
    </font><font color="#0000aa">set</font><font color="#000000"> starter </font><font color="#963700">1</font><font color="#000000"> 
    setup-world]
  </font><font color="#0000aa">ask</font><font color="#000000"> clouds [ </font><font color="#0000aa">fd</font><font color="#000000"> </font><font color="#963700">.3</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> (</font><font color="#963700">0.1</font><font color="#000000"> </font><font color="#660096">+</font><font color="#000000"> (</font><font color="#963700">3</font><font color="#000000"> </font><font color="#660096">+</font><font color="#000000"> cloud-num) </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">10</font><font color="#000000">) ]  </font><font color="#5a5a5a">; move clouds along</font><font color="#000000">
  run-sunshine 
  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> [ update-albedo ]
  run-heat  </font><font color="#5a5a5a">;; moves heat dots</font><font color="#000000">
  run-IR    </font><font color="#5a5a5a">;; moves the IR arrowheads</font><font color="#000000">
  run-CO2   </font><font color="#5a5a5a">;; moves CO2 molecules</font><font color="#000000">
  show-labels             </font><font color="#5a5a5a">; if the forever execution loop is stopped, all the labels are on. </font><font color="#000000">
  </font><font color="#0000aa">tick</font><font color="#000000">
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> update-albedo
  </font><font color="#0000aa">if</font><font color="#000000"> (</font><font color="#660096">pycor</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> earth-top) [ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#963700">50</font><font color="#000000"> </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">9</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> albedo ]
</font><font color="#007f69">end</font><font color="#000000">       

</font><font color="#007f69">to</font><font color="#000000"> setup-world
  </font><font color="#0000aa">set</font><font color="#000000"> albedo </font><font color="#963700">.4</font><font color="#000000">
  </font><font color="#0000aa">set</font><font color="#000000"> sun-brightness </font><font color="#963700">1.2</font><font color="#000000">
  </font><font color="#0000aa">set</font><font color="#000000"> sky-top (</font><font color="#660096">max-pycor</font><font color="#000000"> </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">5</font><font color="#000000">)
  </font><font color="#0000aa">set</font><font color="#000000"> earth-top (</font><font color="#963700">8</font><font color="#000000"> </font><font color="#660096">+</font><font color="#000000"> </font><font color="#660096">min-pycor</font><font color="#000000">)
  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"> [                           </font><font color="#5a5a5a">;; set colors of the world</font><font color="#000000">
      </font><font color="#0000aa">if</font><font color="#000000"> (</font><font color="#660096">pycor</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#660096">max-pycor</font><font color="#000000">) [ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#963700">black</font><font color="#000000"> ]
      </font><font color="#0000aa">if</font><font color="#000000"> (</font><font color="#660096">pycor</font><font color="#000000"> </font><font color="#660096">&lt;</font><font color="#000000"> </font><font color="#660096">max-pycor</font><font color="#000000">) </font><font color="#660096">and</font><font color="#000000"> (</font><font color="#660096">pycor</font><font color="#000000"> </font><font color="#660096">&gt;</font><font color="#000000"> sky-top) [
        </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#963700">9</font><font color="#000000"> </font><font color="#660096">-</font><font color="#000000"> </font><font color="#660096">scale-color</font><font color="#000000"> </font><font color="#963700">white</font><font color="#000000"> </font><font color="#660096">pycor</font><font color="#000000"> sky-top </font><font color="#660096">max-pycor</font><font color="#000000">   ]
      </font><font color="#0000aa">if</font><font color="#000000"> ((</font><font color="#660096">pycor</font><font color="#000000"> </font><font color="#660096">&lt;=</font><font color="#000000"> sky-top) </font><font color="#660096">and</font><font color="#000000"> (</font><font color="#660096">pycor</font><font color="#000000"> </font><font color="#660096">&gt;</font><font color="#000000"> earth-top)) [
        </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#963700">blue</font><font color="#000000"> </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> (</font><font color="#660096">pycor</font><font color="#000000"> </font><font color="#660096">+</font><font color="#000000"> </font><font color="#660096">max-pycor</font><font color="#000000">) </font><font color="#660096">/</font><font color="#000000"> </font><font color="#660096">max-pycor</font><font color="#000000">  ]
      </font><font color="#0000aa">if</font><font color="#000000"> (</font><font color="#660096">pycor</font><font color="#000000"> </font><font color="#660096">&lt;</font><font color="#000000"> earth-top) [ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#963700">red</font><font color="#000000"> </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">3</font><font color="#000000"> ]  
      update-albedo ] 
   create-heats </font><font color="#963700">30</font><font color="#000000"> [ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">heading</font><font color="#000000"> </font><font color="#660096">random</font><font color="#000000"> </font><font color="#963700">360</font><font color="#000000"> </font><font color="#5a5a5a">;; start with some heat energy in the earth</font><font color="#000000">
     </font><font color="#0000aa">setxy</font><font color="#000000"> </font><font color="#660096">min-pxcor</font><font color="#000000"> </font><font color="#660096">+</font><font color="#000000"> </font><font color="#660096">random</font><font color="#000000"> (</font><font color="#660096">max-pxcor</font><font color="#000000"> </font><font color="#660096">-</font><font color="#000000"> </font><font color="#660096">min-pxcor</font><font color="#000000">) </font><font color="#660096">min-pycor</font><font color="#000000"> </font><font color="#660096">+</font><font color="#000000"> </font><font color="#660096">random</font><font color="#000000"> (earth-top </font><font color="#660096">-</font><font color="#000000"> </font><font color="#660096">min-pycor</font><font color="#000000">) </font><font color="#5a5a5a">;; scatter throughout earth</font><font color="#000000">
     </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">13</font><font color="#000000"> </font><font color="#660096">+</font><font color="#000000"> </font><font color="#660096">random</font><font color="#000000"> </font><font color="#963700">4</font><font color="#000000">     
     </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">shape</font><font color="#000000"> </font><font color="#963700">&quot;dot&quot;</font><font color="#000000">  ]
   create-sunrays </font><font color="#963700">20</font><font color="#000000">  [ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">heading</font><font color="#000000"> </font><font color="#963700">160</font><font color="#000000"> </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">yellow</font><font color="#000000">    </font><font color="#5a5a5a">; put in some sunrays</font><font color="#000000">
       </font><font color="#0000aa">setxy</font><font color="#000000"> </font><font color="#660096">min-pxcor</font><font color="#000000"> </font><font color="#660096">+</font><font color="#000000"> </font><font color="#660096">random</font><font color="#000000"> (</font><font color="#660096">max-pxcor</font><font color="#000000"> </font><font color="#660096">-</font><font color="#000000"> </font><font color="#660096">min-pxcor</font><font color="#000000">)  earth-top </font><font color="#660096">+</font><font color="#000000"> </font><font color="#660096">random</font><font color="#000000"> </font><font color="#660096">max-pycor</font><font color="#000000"> </font><font color="#660096">-</font><font color="#000000"> earth-top ]

</font><font color="#007f69">end</font><font color="#000000">      

</font><font color="#007f69">to</font><font color="#000000"> add-cloud            </font><font color="#5a5a5a">;; erase clouds and then create new ones</font><font color="#000000">
  </font><font color="#0000aa">set</font><font color="#000000"> num-clouds num-clouds </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">
  setup-clouds num-clouds
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> remove-cloud
  </font><font color="#0000aa">if</font><font color="#000000"> (num-clouds </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> ) [
      </font><font color="#0000aa">set</font><font color="#000000"> num-clouds num-clouds </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">
      setup-clouds num-clouds ]
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> setup-clouds [ n ] 
  </font><font color="#0000aa">ask</font><font color="#000000"> clouds [ </font><font color="#0000aa">die</font><font color="#000000"> ]
  </font><font color="#0000aa">let</font><font color="#000000"> i </font><font color="#963700">0</font><font color="#000000">
  </font><font color="#0000aa">repeat</font><font color="#000000"> n
     [ make-cloud  i n
     </font><font color="#0000aa">set</font><font color="#000000"> i i </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">]
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> make-cloud [ k n ]                   </font><font color="#5a5a5a">;; makes cloud number k out of n total</font><font color="#000000">
  </font><font color="#0000aa">let</font><font color="#000000"> width sky-top </font><font color="#660096">-</font><font color="#000000"> earth-top
  </font><font color="#0000aa">let</font><font color="#000000"> mid ( sky-top </font><font color="#660096">+</font><font color="#000000"> earth-top ) </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000">
  </font><font color="#0000aa">let</font><font color="#000000"> y mid </font><font color="#660096">+</font><font color="#000000"> width </font><font color="#660096">*</font><font color="#000000"> ((k </font><font color="#660096">/</font><font color="#000000"> n) </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">0.3</font><font color="#000000"> ) </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000">  </font><font color="#5a5a5a">;; the ratio k/n determines its altitude</font><font color="#000000">
  </font><font color="#0000aa">if</font><font color="#000000"> k </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> [</font><font color="#0000aa">set</font><font color="#000000"> y </font><font color="#963700">6</font><font color="#000000"> ]
  </font><font color="#0000aa">let</font><font color="#000000"> x </font><font color="#963700">2</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> (</font><font color="#660096">random</font><font color="#000000"> </font><font color="#660096">max-pxcor</font><font color="#000000"> ) </font><font color="#660096">+</font><font color="#000000"> </font><font color="#660096">min-pxcor</font><font color="#000000">
  </font><font color="#0000aa">repeat</font><font color="#000000"> </font><font color="#963700">3</font><font color="#000000"> </font><font color="#660096">+</font><font color="#000000"> </font><font color="#660096">random</font><font color="#000000"> </font><font color="#963700">20</font><font color="#000000"> [ create-clouds </font><font color="#963700">1</font><font color="#000000">  </font><font color="#5a5a5a">;; lots of turtles make up a cloud</font><font color="#000000">
    [</font><font color="#0000aa">set</font><font color="#000000"> cloud-num k
    </font><font color="#0000aa">setxy</font><font color="#000000"> x </font><font color="#660096">+</font><font color="#000000"> (</font><font color="#660096">random</font><font color="#000000"> </font><font color="#963700">9</font><font color="#000000">) </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">4</font><font color="#000000"> y </font><font color="#660096">+</font><font color="#000000"> </font><font color="#660096">random</font><font color="#000000"> </font><font color="#660096">random</font><font color="#000000"> </font><font color="#963700">5</font><font color="#000000">
    </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">white</font><font color="#000000">
    </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000"> </font><font color="#660096">+</font><font color="#000000"> </font><font color="#660096">random</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000">
    </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">heading</font><font color="#000000"> </font><font color="#963700">90</font><font color="#000000"> 
    </font><font color="#0000aa">Set</font><font color="#000000"> </font><font color="#660096">shape</font><font color="#000000"> </font><font color="#963700">&quot;cloud&quot;</font><font color="#000000"> ]  ]
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> run-sunshine
  </font><font color="#0000aa">ask</font><font color="#000000"> sunrays [
     </font><font color="#0000aa">fd</font><font color="#000000"> </font><font color="#963700">.3</font><font color="#000000">    </font><font color="#5a5a5a">;; move sunrays forward</font><font color="#000000">
     </font><font color="#0000aa">if</font><font color="#000000"> ((</font><font color="#660096">heading</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">20</font><font color="#000000">) </font><font color="#660096">and</font><font color="#000000"> (</font><font color="#660096">ycor</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#660096">max-pycor</font><font color="#000000">)) [ </font><font color="#0000aa">die</font><font color="#000000"> ] ] </font><font color="#5a5a5a">;; kill rays leaving upward</font><font color="#000000">
  create-sunshine  </font><font color="#5a5a5a">;; start new sun rays from top</font><font color="#000000">
  reflect-sunrays-from-clouds  </font><font color="#5a5a5a">;; check for reflection off clouds</font><font color="#000000">
  encounter-earth   </font><font color="#5a5a5a">;; check for reflection off earth and absorbtion</font><font color="#000000">
 </font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> create-sunshine
  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#963700">10</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> sun-brightness </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#660096">random</font><font color="#000000"> </font><font color="#963700">50</font><font color="#000000">
    [ create-sunrays </font><font color="#963700">1</font><font color="#000000"> 
      [ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">heading</font><font color="#000000"> </font><font color="#963700">160</font><font color="#000000">
      </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">yellow</font><font color="#000000">
      </font><font color="#0000aa">setxy</font><font color="#000000"> </font><font color="#660096">min-pxcor</font><font color="#000000"> </font><font color="#660096">+</font><font color="#000000"> </font><font color="#660096">random</font><font color="#000000"> (</font><font color="#660096">max-pxcor</font><font color="#000000"> </font><font color="#660096">-</font><font color="#000000"> </font><font color="#660096">min-pxcor</font><font color="#000000">)  </font><font color="#660096">max-pycor</font><font color="#000000"> ] ] </font><font color="#5a5a5a">;; start the sunrays anywhere along the top</font><font color="#000000">
</font><font color="#007f69">end</font><font color="#000000">
 
</font><font color="#007f69">to</font><font color="#000000"> reflect-sunrays-from-clouds
 </font><font color="#0000aa">ask</font><font color="#000000"> sunrays [
    </font><font color="#0000aa">if</font><font color="#000000"> (</font><font color="#660096">count</font><font color="#000000"> clouds-here </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> ) [   </font><font color="#5a5a5a">;; if sunray shares patch with a cloud</font><font color="#000000">
      </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">heading</font><font color="#000000"> </font><font color="#963700">180</font><font color="#000000"> </font><font color="#660096">-</font><font color="#000000"> </font><font color="#660096">heading</font><font color="#000000"> ]]  </font><font color="#5a5a5a">;; turn the sunray around</font><font color="#000000">
</font><font color="#007f69">end</font><font color="#000000"> 

</font><font color="#007f69">to</font><font color="#000000"> encounter-earth
  </font><font color="#0000aa">ask</font><font color="#000000"> sunrays [
    </font><font color="#0000aa">if</font><font color="#000000"> (</font><font color="#660096">ycor</font><font color="#000000"> </font><font color="#660096">&lt;=</font><font color="#000000"> earth-top) [
      </font><font color="#0000aa">ifelse</font><font color="#000000"> (</font><font color="#963700">100</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> albedo </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#660096">random</font><font color="#000000"> </font><font color="#963700">100</font><font color="#000000">) 
          [ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">heading</font><font color="#000000"> </font><font color="#963700">20</font><font color="#000000">  ]           </font><font color="#5a5a5a">;; reflect</font><font color="#000000">
          [ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">heading</font><font color="#000000"> </font><font color="#963700">95</font><font color="#000000"> </font><font color="#660096">+</font><font color="#000000"> </font><font color="#660096">random</font><font color="#000000"> </font><font color="#963700">170</font><font color="#000000"> </font><font color="#5a5a5a">;; morph into heat energy</font><font color="#000000">
            </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">13</font><font color="#000000"> </font><font color="#660096">+</font><font color="#000000"> </font><font color="#660096">random</font><font color="#000000"> </font><font color="#963700">4</font><font color="#000000">  
            </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">breed</font><font color="#000000"> heats    
            </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">shape</font><font color="#000000"> </font><font color="#963700">&quot;dot&quot;</font><font color="#000000">  ]]]
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> run-heat    </font><font color="#5a5a5a">;; advances the heat energy turtles</font><font color="#000000">
  </font><font color="#0000aa">set</font><font color="#000000"> temperature </font><font color="#963700">.99</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> temperature </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">.01</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> (</font><font color="#963700">-1</font><font color="#000000"> </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">.2</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> </font><font color="#660096">count</font><font color="#000000"> heats) </font><font color="#5a5a5a">;; the temperature is related to the number of heat turtles</font><font color="#000000">
  </font><font color="#0000aa">ask</font><font color="#000000"> heats [
    </font><font color="#0000aa">fd</font><font color="#000000"> </font><font color="#963700">.5</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> ( </font><font color="#660096">random</font><font color="#000000"> </font><font color="#963700">11</font><font color="#000000"> ) </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">10</font><font color="#000000">
    </font><font color="#0000aa">if</font><font color="#000000"> (</font><font color="#660096">ycor</font><font color="#000000"> </font><font color="#660096">&lt;=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> </font><font color="#660096">+</font><font color="#000000"> </font><font color="#660096">min-pycor</font><font color="#000000"> )[ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">heading</font><font color="#000000"> </font><font color="#963700">70</font><font color="#000000"> </font><font color="#660096">-</font><font color="#000000"> </font><font color="#660096">random</font><font color="#000000"> </font><font color="#963700">170</font><font color="#000000"> ] </font><font color="#5a5a5a">;; if heading into the earth's core, bounce</font><font color="#000000">
    </font><font color="#0000aa">if</font><font color="#000000"> (</font><font color="#660096">ycor</font><font color="#000000"> </font><font color="#660096">&gt;=</font><font color="#000000"> earth-top ) [  </font><font color="#5a5a5a">;; if heading back into sky</font><font color="#000000">
      </font><font color="#0000aa">ifelse</font><font color="#000000"> (temperature </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">-20</font><font color="#000000"> </font><font color="#660096">+</font><font color="#000000"> </font><font color="#660096">random</font><font color="#000000"> </font><font color="#963700">200</font><font color="#000000">)    </font><font color="#5a5a5a">;; select some to escape, more if it is hot</font><font color="#000000">
        [ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">breed</font><font color="#000000"> IRs
        </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">heading</font><font color="#000000"> </font><font color="#963700">-50</font><font color="#000000"> </font><font color="#660096">+</font><font color="#000000"> </font><font color="#660096">random</font><font color="#000000"> </font><font color="#963700">100</font><font color="#000000"> </font><font color="#5a5a5a">;; start the IR off in a random upward direction</font><font color="#000000">
        </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">magenta</font><font color="#000000"> 
        </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">shape</font><font color="#000000"> </font><font color="#963700">&quot;default&quot;</font><font color="#000000"> ]           </font><font color="#5a5a5a">;; let them escape as IR with arrowhead shapes</font><font color="#000000">
      [ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">heading</font><font color="#000000"> </font><font color="#963700">100</font><font color="#000000"> </font><font color="#660096">+</font><font color="#000000"> </font><font color="#660096">random</font><font color="#000000"> </font><font color="#963700">160</font><font color="#000000"> ]]] </font><font color="#5a5a5a">;; otherwise return them to earth</font><font color="#000000">
</font><font color="#007f69">end</font><font color="#000000"> 

</font><font color="#007f69">to</font><font color="#000000"> run-IR
  </font><font color="#0000aa">ask</font><font color="#000000"> IRs [
    </font><font color="#0000aa">fd</font><font color="#000000"> </font><font color="#963700">.3</font><font color="#000000">
    </font><font color="#0000aa">if</font><font color="#000000"> (</font><font color="#660096">ycor</font><font color="#000000"> </font><font color="#660096">&gt;=</font><font color="#000000"> </font><font color="#660096">max-pycor</font><font color="#000000"> ) [ </font><font color="#0000aa">die</font><font color="#000000"> ]
    </font><font color="#0000aa">if</font><font color="#000000"> (</font><font color="#660096">ycor</font><font color="#000000"> </font><font color="#660096">&lt;=</font><font color="#000000"> earth-top ) [   </font><font color="#5a5a5a">;; convert to heat </font><font color="#000000">
      </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">breed</font><font color="#000000"> heats
      </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">heading</font><font color="#000000"> </font><font color="#963700">95</font><font color="#000000"> </font><font color="#660096">+</font><font color="#000000"> </font><font color="#660096">random</font><font color="#000000"> </font><font color="#963700">170</font><font color="#000000">
      </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">13</font><font color="#000000"> </font><font color="#660096">+</font><font color="#000000"> </font><font color="#660096">random</font><font color="#000000"> </font><font color="#963700">4</font><font color="#000000">  
      </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">shape</font><font color="#000000"> </font><font color="#963700">&quot;dot&quot;</font><font color="#000000"> ]
    </font><font color="#0000aa">if</font><font color="#000000"> (</font><font color="#660096">count</font><font color="#000000"> CO2s-here </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">)   </font><font color="#5a5a5a">;; check for collision with CO2</font><font color="#000000">
      [ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">heading</font><font color="#000000"> </font><font color="#660096">random</font><font color="#000000"> </font><font color="#963700">360</font><font color="#000000"> ]] </font><font color="#5a5a5a">;; send off in a new direction</font><font color="#000000">
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> add-CO2  </font><font color="#5a5a5a">;; randomly adds 25 CO2 molecules to atmosphere</font><font color="#000000">
  </font><font color="#0000aa">let</font><font color="#000000"> width sky-top </font><font color="#660096">-</font><font color="#000000"> earth-top
  </font><font color="#0000aa">if</font><font color="#000000"> (num-CO2 </font><font color="#660096">&lt;</font><font color="#000000"> </font><font color="#963700">150</font><font color="#000000">) [  </font><font color="#5a5a5a">;; stop adding CO2 at 150 molecules--more slow the model too much</font><font color="#000000">
    </font><font color="#0000aa">repeat</font><font color="#000000"> </font><font color="#963700">25</font><font color="#000000"> [
      create-CO2s </font><font color="#963700">1</font><font color="#000000">
        [</font><font color="#0000aa">let</font><font color="#000000"> i </font><font color="#660096">random</font><font color="#000000"> </font><font color="#963700">3</font><font color="#000000">
          </font><font color="#0000aa">if</font><font color="#000000"> i </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">shape</font><font color="#000000"> </font><font color="#963700">&quot;co2&quot;</font><font color="#000000">]
          </font><font color="#0000aa">if</font><font color="#000000"> i </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">shape</font><font color="#000000"> </font><font color="#963700">&quot;molecule water&quot;</font><font color="#000000">]
          </font><font color="#0000aa">if</font><font color="#000000"> i </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000"> [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">shape</font><font color="#000000"> </font><font color="#963700">&quot;black ball&quot;</font><font color="#000000">]
          </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">black</font><font color="#000000">
          </font><font color="#0000aa">setxy</font><font color="#000000"> </font><font color="#660096">random</font><font color="#000000"> (</font><font color="#963700">2</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> </font><font color="#660096">max-pxcor</font><font color="#000000">) </font><font color="#660096">+</font><font color="#000000"> </font><font color="#660096">min-pxcor</font><font color="#000000"> earth-top </font><font color="#660096">+</font><font color="#000000"> </font><font color="#660096">random</font><font color="#000000"> width
          </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">heading</font><font color="#000000"> </font><font color="#660096">random</font><font color="#000000"> </font><font color="#963700">360</font><font color="#000000"> ]] </font><font color="#5a5a5a">;; heading is used to spin molecule </font><font color="#000000">
  </font><font color="#0000aa">set</font><font color="#000000"> num-CO2 </font><font color="#660096">count</font><font color="#000000"> CO2s ]  
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> remove-CO2 </font><font color="#5a5a5a">;; randomly remove 25 CO2 molecules</font><font color="#000000">
  </font><font color="#0000aa">repeat</font><font color="#000000"> </font><font color="#963700">25</font><font color="#000000"> [
    </font><font color="#0000aa">if</font><font color="#000000"> (</font><font color="#660096">count</font><font color="#000000"> CO2s </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> ) [
      </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">one-of</font><font color="#000000"> CO2s [ </font><font color="#0000aa">die</font><font color="#000000"> ]]]
  </font><font color="#0000aa">set</font><font color="#000000"> num-CO2 </font><font color="#660096">count</font><font color="#000000"> CO2s
</font><font color="#007f69">end</font><font color="#000000">

</font><font color="#007f69">to</font><font color="#000000"> run-CO2
  </font><font color="#0000aa">let</font><font color="#000000"> d </font><font color="#963700">0</font><font color="#000000">
  </font><font color="#0000aa">ask</font><font color="#000000"> CO2s [
    </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">heading</font><font color="#000000"> </font><font color="#660096">heading</font><font color="#000000"> </font><font color="#660096">+</font><font color="#000000"> (</font><font color="#660096">random</font><font color="#000000"> </font><font color="#963700">51</font><font color="#000000">) </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">25</font><font color="#000000"> </font><font color="#5a5a5a">;; turn a bit</font><font color="#000000">
    </font><font color="#0000aa">fd</font><font color="#000000"> </font><font color="#963700">.01</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> (</font><font color="#963700">5</font><font color="#000000"> </font><font color="#660096">+</font><font color="#000000"> </font><font color="#660096">random</font><font color="#000000"> </font><font color="#963700">10</font><font color="#000000">) </font><font color="#5a5a5a">;; move forward a bit</font><font color="#000000">
    </font><font color="#0000aa">if</font><font color="#000000"> (</font><font color="#660096">ycor</font><font color="#000000"> </font><font color="#660096">&lt;=</font><font color="#000000"> earth-top </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">) [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">heading</font><font color="#000000"> </font><font color="#963700">45</font><font color="#000000"> </font><font color="#660096">-</font><font color="#000000"> </font><font color="#660096">random</font><font color="#000000"> </font><font color="#963700">90</font><font color="#000000"> ] </font><font color="#5a5a5a">;; bounce off earth</font><font color="#000000">
    </font><font color="#0000aa">if</font><font color="#000000"> (</font><font color="#660096">ycor</font><font color="#000000"> </font><font color="#660096">&gt;=</font><font color="#000000"> sky-top) [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">heading</font><font color="#000000"> </font><font color="#963700">135</font><font color="#000000"> </font><font color="#660096">+</font><font color="#000000"> </font><font color="#660096">random</font><font color="#000000"> </font><font color="#963700">90</font><font color="#000000">] ] </font><font color="#5a5a5a">;; bounce off sky top</font><font color="#000000">
</font><font color="#007f69">end</font><font color="#000000">
















</font>
</pre>

</body>
</html>
